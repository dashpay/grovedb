name: Slow Tests

on:
  workflow_dispatch:
  pull_request:
    branches:
      - master
      - develop
      - 'v[0-9]*.[0-9]*-dev'
    paths:
      - 'grovedb-commitment-tree/**'
      - '.github/workflows/slow-tests.yml'

jobs:
  slow-tests:
    name: Commitment Tree slow tests
    runs-on: ubuntu-22.04
    steps:
      - uses: actions/checkout@v4
        with:
          submodules: recursive

      - name: Setup Rust
        uses: dtolnay/rust-toolchain@stable

      - name: Enable Rust cache
        uses: Swatinem/rust-cache@v2
        with:
          cache-on-failure: "false"

      - name: Run ignored (slow) tests
        run: cargo test -p grovedb-commitment-tree -- --ignored
