# 量子暗号 — ポスト量子脅威分析

本章では、量子コンピュータが GroveDB およびその上に構築されたシールド
トランザクションプロトコル（Orchard、Dash Platform）で使用される暗号
プリミティブにどのように影響するかを分析します。脆弱なコンポーネント、
安全なコンポーネント、保存データにとっての「今収集し、後で復号する」の
意味、そしてハイブリッド KEM 設計を含む緩和戦略について説明します。

## 重要な2つの量子アルゴリズム

実際に暗号学に関連する量子アルゴリズムは2つだけです：

**Shor のアルゴリズム**は、離散対数問題（および整数の因数分解）を多項式
時間で解きます。Pallas のような 255 ビット楕円曲線の場合、約 510 論理
量子ビットが必要ですが、エラー訂正のオーバーヘッドを考慮すると、実際の
要件は約 400 万物理量子ビットです。Shor のアルゴリズムは鍵サイズに
関係なく、すべての楕円曲線暗号を**完全に破壊**します。

**Grover のアルゴリズム**は、総当たり探索に対して二次的な高速化を提供
します。256 ビットの対称鍵は実質的に 128 ビットになります。しかし、
128 ビット鍵空間に対する Grover の回路深度は依然として 2^64 量子操作
であり、多くの暗号学者はデコヒーレンスの制限により、実際のハードウェア
では決して実用的にならないと考えています。Grover はセキュリティマージン
を減少させますが、適切にパラメータ化された対称暗号を破壊しません。

| アルゴリズム | 対象 | 高速化 | 実際の影響 |
|------------|------|--------|----------|
| **Shor** | ECC 離散対数、RSA 因数分解 | 指数的（多項式時間） | ECC の**完全な破壊** |
| **Grover** | 対称鍵探索、ハッシュ原像 | 二次的（鍵ビット数を半減） | 256 ビット → 128 ビット（依然安全） |

## GroveDB の暗号プリミティブ

GroveDB と Orchard ベースのシールドプロトコルは、楕円曲線プリミティブと
対称/ハッシュベースプリミティブを組み合わせて使用しています。以下の表は
各プリミティブを量子脆弱性で分類しています：

### 量子脆弱（Shor のアルゴリズム — ポスト量子で 0 ビット）

| プリミティブ | 使用箇所 | 破壊される内容 |
|------------|---------|-------------|
| **Pallas ECDLP** | ノートコミットメント（cmx）、一時鍵（epk/esk）、閲覧鍵（ivk）、支払鍵（pk_d）、ヌリファイア導出 | 公開鍵から任意の秘密鍵を復元 |
| **ECDH 鍵合意**（Pallas） | ノート暗号文の対称暗号鍵の導出 | 共有秘密の復元 → 全ノートの復号 |
| **Sinsemilla ハッシュ** | CommitmentTree のマークルパス、回路内ハッシュ | 衝突耐性が ECDLP に依存; Pallas 破壊時に劣化 |
| **Halo 2 IPA** | ZK 証明システム（Pasta 曲線上の多項式コミットメント） | 偽の命題に対する証明の偽造（偽造、無許可の支出） |
| **Pedersen コミットメント** | トランザクション金額を隠す値コミットメント（cv_net） | 隠された金額の復元; 残高証明の偽造 |

### 量子安全（Grover のアルゴリズム — ポスト量子で 128 ビット以上）

| プリミティブ | 使用箇所 | ポスト量子セキュリティ |
|------------|---------|-------------------|
| **Blake3** | Merk ツリーノードハッシュ、MMR ノード、BulkAppendTree 状態ルート、サブツリーパスプレフィックス | 128 ビット原像、128 ビット第二原像 |
| **BLAKE2b-256** | 対称鍵導出の KDF、送信暗号鍵、PRF^expand | 128 ビット原像 |
| **ChaCha20-Poly1305** | enc_ciphertext と out_ciphertext の暗号化（256 ビット鍵） | 128 ビット鍵探索（安全だが、ECDH 経由の鍵導出パスは安全ではない） |
| **PRF^expand**（BLAKE2b-512） | rseed から esk、rcm、psi を導出 | 128 ビット PRF セキュリティ |

### GroveDB インフラストラクチャ：完全に量子安全

GroveDB 自体のすべてのデータ構造は Blake3 ハッシュのみに依存しています：

- **Merk AVL ツリー** — ノードハッシュ、combined_value_hash、子ハッシュ伝播
- **MMR ツリー** — 内部ノードハッシュ、ピーク計算、ルート導出
- **BulkAppendTree** — バッファハッシュチェーン、密マークルルート、エポック MMR
- **CommitmentTree 状態ルート** — `blake3("ct_state" || sinsemilla_root || bulk_state_root)`
- **サブツリーパスプレフィックス** — パスセグメントの Blake3 ハッシュ
- **V1 証明** — Merk 階層を通じた認証チェーン

**変更不要。** GroveDB の Merk ツリー証明、MMR 整合性チェック、
BulkAppendTree エポックルート、およびすべての V1 証明認証チェーンは
量子コンピュータに対して安全なままです。ハッシュベースのインフラストラクチャ
はポスト量子においてシステムの最も堅固な部分です。

## 遡及的脅威とリアルタイム脅威

この区別は、何をいつ修正するかの優先順位付けにおいて重要です。

**遡及的脅威**は既に保存されているデータを危険にさらします。攻撃者は
今日データを記録し、量子コンピュータが利用可能になったときに復号します。
これらの脅威は**事後に緩和できません**——データがオンチェーンに載ると、
再暗号化や撤回はできません。

**リアルタイム脅威**は将来作成されるトランザクションにのみ影響します。
量子コンピュータを持つ攻撃者は署名や証明を偽造できますが、新しい
トランザクションに対してのみです。過去のトランザクションは既にネットワーク
によって検証・確認されています。

| 脅威 | タイプ | 露出する内容 | 緊急度 |
|------|-------|------------|--------|
| **ノート復号**（enc_ciphertext） | **遡及的** | ノート内容: 受取人、金額、メモ、rseed | **高** — 永久に保存 |
| **値コミットメント開示**（cv_net） | **遡及的** | トランザクション金額（送信者/受取人は除く） | **中** — 金額のみ |
| **送信者回復データ**（out_ciphertext） | **遡及的** | 送信ノートの送信者回復鍵 | **高** — 永久に保存 |
| 支出認可偽造 | リアルタイム | 新しい支出署名の偽造が可能 | 低 — QC 到来前にアップグレード |
| Halo 2 証明偽造 | リアルタイム | 新しい証明の偽造が可能（偽造品） | 低 — QC 到来前にアップグレード |
| Sinsemilla 衝突 | リアルタイム | 新しいマークルパスの偽造が可能 | 低 — 証明偽造に包含される |
| バインディング署名偽造 | リアルタイム | 新しい残高証明の偽造が可能 | 低 — QC 到来前にアップグレード |

### 具体的に何が露出するか？

**ノート暗号が破られた場合**（主要な HNDL 脅威）：

量子攻撃者は Shor のアルゴリズムにより保存された `epk` から `esk` を復元し、
ECDH 共有秘密を計算し、対称鍵を導出し、`enc_ciphertext` を復号します。
これによりノートの完全な平文が明らかになります：

| フィールド | サイズ | 明らかになる内容 |
|-----------|-------|----------------|
| version | 1 バイト | プロトコルバージョン（非機密） |
| diversifier | 11 バイト | 受取人のアドレスコンポーネント |
| value | 8 バイト | 正確なトランザクション金額 |
| rseed | 32 バイト | ヌリファイアのリンクが可能（トランザクショングラフの非匿名化） |
| memo | 36 バイト（DashMemo） | アプリケーションデータ、識別可能性あり |

`rseed` と `rho`（暗号文と共に保存）があれば、攻撃者は
`esk = PRF(rseed, rho)` を計算し、一時鍵のバインディングを検証できます。
diversifier と組み合わせることで、トランザクション履歴全体にわたって入力と
出力がリンクされます——**シールドプールの完全な非匿名化**。

**値コミットメントのみが破られた場合**（二次的 HNDL 脅威）：

攻撃者は ECDLP を解くことで `cv_net = [v]*V + [rcv]*R` から `v` を復元
します。これは**トランザクション金額を明らかにしますが、送信者や受取人の
身元は明らかにしません**。攻撃者は「誰かが誰かに 5.0 Dash を送った」と
見えますが、ノート暗号も破らない限り、金額をアドレスや身元にリンクできません。

金額だけではリンクなしの場合、有用性は限られます。しかし、外部データ
（タイミング、既知の請求書、公開リクエストと一致する金額）と組み合わせると、
相関攻撃が可能になります。

## 「今収集し、後で復号する」攻撃

これは最も緊急で実用的な量子脅威です。

**攻撃モデル：**国家レベルの攻撃者（または十分なストレージを持つ任意の
当事者）が、今日のブロックチェーン上のすべてのシールドトランザクションデータ
を記録します。このデータはブロックチェーン上で公開されており、不変です。
攻撃者は暗号学的に関連する量子コンピュータ（CRQC）を待ち、その後：

```text
Step 1: Read stored record from CommitmentTree BulkAppendTree:
        cmx (32) || rho (32) || epk (32) || enc_ciphertext (104) || out_ciphertext (80)

Step 2: Solve ECDLP on Pallas via Shor's algorithm:
        epk = [esk] * g_d  →  recover esk

Step 3: Compute shared secret:
        shared_secret = [esk] * pk_d

Step 4: Derive symmetric key (BLAKE2b is quantum-safe, but input is compromised):
        K_enc = BLAKE2b-256("Zcash_OrchardKDF", shared_secret || epk)

Step 5: Decrypt enc_ciphertext using ChaCha20-Poly1305:
        → version || diversifier || value || rseed || memo

Step 6: With rseed + rho, link nullifiers to note commitments:
        esk = PRF(rseed, rho)
        → full transaction graph reconstruction
```

**重要な洞察：**対称暗号（ChaCha20-Poly1305）は完全に量子安全です。
脆弱性は完全に**鍵導出パス**にあります——対称鍵は ECDH 共有秘密から導出
され、ECDH は Shor のアルゴリズムによって破られます。攻撃者は暗号を
破るのではなく、鍵を復元するのです。

**遡及性：**この攻撃は**完全に遡及的**です。CRQC が存在すれば、オンチェーン
に保存されたすべての暗号化ノートを復号できます。データは事後に再暗号化
したり保護したりすることはできません。だからこそ、データが保存される前に
対処しなければならず、保存後ではありません。

## 緩和策略：ハイブリッド KEM（ML-KEM + ECDH）

HNDL に対する防御は、**2つの独立した鍵合意メカニズム**から対称暗号鍵を
導出し、一方のみの破壊では不十分にすることです。これをハイブリッド KEM
と呼びます。

### ML-KEM-768（CRYSTALS-Kyber）

ML-KEM は NIST 標準化（FIPS 203、2024 年 8 月）されたポスト量子鍵
カプセル化メカニズムで、Module Learning With Errors（MLWE）問題に
基づいています。

| パラメータ | ML-KEM-512 | ML-KEM-768 | ML-KEM-1024 |
|-----------|-----------|-----------|------------|
| 公開鍵（ek） | 800 バイト | **1,184 バイト** | 1,568 バイト |
| 暗号文（ct） | 768 バイト | **1,088 バイト** | 1,568 バイト |
| 共有秘密 | 32 バイト | 32 バイト | 32 バイト |
| NIST カテゴリ | 1（128 ビット） | **3（192 ビット）** | 5（256 ビット） |

**ML-KEM-768** が推奨される選択肢です——X-Wing、Signal の PQXDH、
Chrome/Firefox TLS ハイブリッド鍵交換で使用されるパラメータセットです。
カテゴリ 3 は将来の格子暗号解析の進歩に対して十分なマージンを提供します。

### ハイブリッドスキームの仕組み

**現在のフロー（脆弱）：**

```text
Sender:
  esk = PRF(rseed, rho)                    // deterministic from note
  epk = [esk] * g_d                         // Pallas curve point
  shared_secret = [esk] * pk_d              // ECDH (broken by Shor's)
  K_enc = BLAKE2b("Zcash_OrchardKDF", shared_secret || epk)
  enc_ciphertext = ChaCha20(K_enc, note_plaintext)
```

**ハイブリッドフロー（量子耐性）：**

```text
Sender:
  esk = PRF(rseed, rho)                    // unchanged
  epk = [esk] * g_d                         // unchanged
  ss_ecdh = [esk] * pk_d                    // same ECDH

  (ct_pq, ss_pq) = ML-KEM-768.Encaps(ek_pq)  // NEW: lattice-based KEM
                                                // ek_pq from recipient's address

  K_enc = BLAKE2b(                          // MODIFIED: combines both secrets
      "DashPlatform_HybridKDF",
      ss_ecdh || ss_pq || ct_pq || epk
  )

  enc_ciphertext = ChaCha20(K_enc, note_plaintext)  // unchanged
```

**受取人による復号：**

```text
Recipient:
  ss_ecdh = [ivk] * epk                    // same ECDH (using incoming viewing key)
  ss_pq = ML-KEM-768.Decaps(dk_pq, ct_pq)  // NEW: KEM decapsulation
  K_enc = BLAKE2b("DashPlatform_HybridKDF", ss_ecdh || ss_pq || ct_pq || epk)
  note_plaintext = ChaCha20.Decrypt(K_enc, enc_ciphertext)
```

### セキュリティ保証

結合 KEM は、**いずれか**のコンポーネント KEM が安全であれば IND-CCA2
安全です。これは PRF を使用する KEM コンバイナ（BLAKE2b が該当）について
[Giacon、Heuer、Poettering（2018）](https://eprint.iacr.org/2018/024)
により正式に証明されており、
[X-Wing セキュリティ証明](https://eprint.iacr.org/2024/039)によっても
独立に証明されています。

| シナリオ | ECDH | ML-KEM | 結合鍵 | ステータス |
|---------|------|--------|-------|----------|
| 古典的世界 | 安全 | 安全 | **安全** | 両方健全 |
| 量子が ECC を破壊 | **破壊** | 安全 | **安全** | ML-KEM が保護 |
| 格子の進歩が ML-KEM を破壊 | 安全 | **破壊** | **安全** | ECDH が保護（今日と同じ） |
| 両方破壊 | 破壊 | 破壊 | **破壊** | 2つの同時突破が必要 |

### サイズへの影響

ハイブリッド KEM は各保存ノートに ML-KEM-768 暗号文（1,088 バイト）を
追加し、送信者回復用の ML-KEM 共有秘密を含めるために送信暗号文を拡張します：

**ノートごとの保存レコード：**

```text
┌──────────────────────────────────────────────────────────────────┐
│  Current (280 bytes)         Hybrid (1,400 bytes)               │
│                                                                  │
│  cmx:             32         cmx:              32               │
│  rho:             32         rho:              32               │
│  epk:             32         epk:              32               │
│  enc_ciphertext: 104         ct_pq:         1,088  ← NEW       │
│  out_ciphertext:  80         enc_ciphertext:  104               │
│                              out_ciphertext:  112  ← +32        │
│  ─────────────────           ──────────────────────             │
│  Total:          280         Total:          1,400  (5.0x)      │
└──────────────────────────────────────────────────────────────────┘
```

**大規模ストレージ：**

| ノート数 | 現在（280 B） | ハイブリッド（1,400 B） | 差分 |
|---------|-------------|---------------------|------|
| 100,000 | 26.7 MB | 133 MB | +106 MB |
| 1,000,000 | 267 MB | 1.33 GB | +1.07 GB |
| 10,000,000 | 2.67 GB | 13.3 GB | +10.7 GB |

**アドレスサイズ：**

```text
Current:  diversifier (11) + pk_d (32) = 43 bytes
Hybrid:   diversifier (11) + pk_d (32) + ek_pq (1,184) = 1,227 bytes
```

1,184 バイトの ML-KEM 公開鍵は、送信者がカプセル化を実行できるように
アドレスに含める必要があります。約 1,960 の Bech32m 文字で大きいですが、
QR コード（最大約 2,953 英数字）に収まります。

### 鍵管理

ML-KEM 鍵ペアは支出鍵から決定論的に導出されます：

```text
SpendingKey (sk) [32 bytes]
  |
  +-> ... (all existing Orchard key derivation unchanged)
  |
  +-> ml_kem_d = PRF^expand(sk, [0x09])[0..32]
  +-> ml_kem_z = PRF^expand(sk, [0x0A])[0..32]
        |
        +-> (ek_pq, dk_pq) = ML-KEM-768.KeyGen(d=ml_kem_d, z=ml_kem_z)
              ek_pq: 1,184 bytes (public, included in address)
              dk_pq: 2,400 bytes (private, part of viewing key)
```

**バックアップの変更は不要。**既存の 24 ワードシードフレーズは ML-KEM 鍵を
カバーします。支出鍵から決定論的に導出されるためです。ウォレットの回復は
以前と同様に機能します。

**多様化アドレス**は同じ `ek_pq` を共有します。ML-KEM には Pallas スカラー
乗算のような自然な多様化メカニズムがないためです。これは、ユーザーの
アドレスを2つ持つ観察者が `ek_pq` を比較してリンクできることを意味します。

### 試行復号のパフォーマンス

| ステップ | 現在 | ハイブリッド | 差分 |
|---------|------|-----------|------|
| Pallas ECDH | ~100 us | ~100 us | — |
| ML-KEM-768 Decaps | — | ~40 us | +40 us |
| BLAKE2b KDF | ~0.5 us | ~1 us | — |
| ChaCha20（52 バイト） | ~0.1 us | ~0.1 us | — |
| **ノートあたり合計** | **~101 us** | **~141 us** | **+40% オーバーヘッド** |

100,000 ノートのスキャン：~10.1 秒 → ~14.1 秒。オーバーヘッドは顕著ですが
禁止的ではありません。ML-KEM デカプセル化は定数時間でバッチ処理の利点が
ありません（楕円曲線操作とは異なり）、そのため線形にスケールします。

### ZK 回路への影響

**なし。**ハイブリッド KEM はトランスポート/暗号化レイヤーに完全に
含まれます。Halo 2 回路はノートの存在、ヌリファイアの正確性、値の
バランスを証明しますが、暗号化については何も証明しません。証明鍵、
検証鍵、回路制約の変更は不要です。

### 業界との比較

| システム | アプローチ | ステータス |
|---------|----------|----------|
| **Signal**（PQXDH） | X25519 + ML-KEM-768、全ユーザー必須 | **デプロイ済み**（2023） |
| **Chrome/Firefox TLS** | X25519 + ML-KEM-768 ハイブリッド鍵交換 | **デプロイ済み**（2024） |
| **X-Wing**（IETF ドラフト） | X25519 + ML-KEM-768、専用コンバイナ | ドラフト標準 |
| **Zcash** | 量子回復性ドラフト ZIP（資金回復、暗号化ではない） | 議論のみ |
| **Dash Platform** | Pallas ECDH + ML-KEM-768（提案中） | 設計フェーズ |

## デプロイ時期

### タイムラインの問題

- **現状（2026）：**255 ビット ECC を破れる量子コンピュータは存在しません。
  実証された最大の量子因数分解：約 50 ビット。ギャップ：桁違い。
- **短期（2030-2035）：**IBM、Google、Quantinuum のハードウェアロードマップ
  は数百万量子ビットを目標としています。ML-KEM の実装とパラメータセットが
  成熟するでしょう。
- **中期（2035-2050）：**多くの推定では CRQC の到来をこの期間に置いています。
  今日収集された HNDL データはリスクにさらされています。
- **長期（2050+）：**暗号学者間のコンセンサス：大規模量子コンピュータは
  「いつ」の問題であり、「もし」ではありません。

### 推奨戦略

**1. 今すぐアップグレード可能性を設計に組み込む。**保存レコード形式、
`TransmittedNoteCiphertext` 構造体、BulkAppendTree エントリレイアウトが
バージョン管理され拡張可能であることを確認する。低コストで、後からハイブリッド
KEM を追加するオプションを維持します。

**2. 準備ができたらハイブリッド KEM をデプロイし、必須にする。**2つのプール
（クラシックとハイブリッド）を提供しない。匿名セットを分割するとシールド
トランザクションの目的が損なわれます——小さなグループに隠れるユーザーは
プライバシーが低くなり、高くはなりません。デプロイ時、すべてのノートが
ハイブリッドスキームを使用します。

**3. 2028-2030 の期間を目標にする。**これは現実的な量子脅威のかなり前ですが、
ML-KEM の実装とパラメータサイズが安定した後です。Zcash と Signal のデプロイ
経験から学ぶこともできます。

**4. トリガーイベントを監視する：**
- NIST または NSA がポスト量子移行期限を義務化
- 量子ハードウェアの大幅な進歩（>100,000 物理量子ビットとエラー訂正）
- 格子問題に対する暗号解析の進歩（ML-KEM の選択に影響）

### 緊急の対応が不要なもの

| コンポーネント | 待てる理由 |
|-------------|----------|
| 支出認可署名 | 偽造はリアルタイムであり遡及的ではない。CRQC 到来前に ML-DSA/SLH-DSA にアップグレード。 |
| Halo 2 証明システム | 証明偽造はリアルタイム。必要に応じて STARK ベースシステムに移行。 |
| Sinsemilla 衝突耐性 | 新しい攻撃にのみ有用で遡及的ではない。証明システム移行に包含される。 |
| GroveDB Merk/MMR/Blake3 インフラストラクチャ | **既に量子安全。**今も将来も対応不要。 |

## ポスト量子代替案リファレンス

### 暗号化用（ECDH の代替）

| スキーム | タイプ | 公開鍵 | 暗号文 | NIST カテゴリ | 備考 |
|---------|-------|-------|-------|-------------|------|
| ML-KEM-768 | 格子（MLWE） | 1,184 B | 1,088 B | 3（192 ビット） | FIPS 203、業界標準 |
| ML-KEM-512 | 格子（MLWE） | 800 B | 768 B | 1（128 ビット） | 小型、マージン低 |
| ML-KEM-1024 | 格子（MLWE） | 1,568 B | 1,568 B | 5（256 ビット） | ハイブリッドには過剰 |

### 署名用（RedPallas/Schnorr の代替）

| スキーム | タイプ | 公開鍵 | 署名 | NIST カテゴリ | 備考 |
|---------|-------|-------|------|-------------|------|
| ML-DSA-65（Dilithium） | 格子 | 1,952 B | 3,293 B | 3 | FIPS 204、高速 |
| SLH-DSA（SPHINCS+） | ハッシュベース | 32-64 B | 7,856-49,856 B | 1-5 | FIPS 205、保守的 |
| XMSS/LMS | ハッシュベース（ステートフル） | 60 B | 2,500 B | 可変 | ステートフル — 再利用＝破壊 |

### ZK 証明用（Halo 2 の代替）

| システム | 仮定 | 証明サイズ | ポスト量子 | 備考 |
|---------|------|---------|----------|------|
| STARKs | ハッシュ関数（衝突耐性） | ~100-400 KB | **はい** | StarkNet で使用 |
| Plonky3 | FRI（ハッシュベース多項式コミットメント） | ~50-200 KB | **はい** | 活発に開発中 |
| Halo 2（現行） | Pasta 曲線上の ECDLP | ~5 KB | **いいえ** | 現在の Orchard システム |
| Lattice SNARKs | MLWE | 研究段階 | **はい** | 本番未対応 |

### Rust クレートエコシステム

| クレート | ソース | FIPS 203 | 検証済み | 備考 |
|---------|-------|----------|---------|------|
| `libcrux-ml-kem` | Cryspen | はい | 形式検証済み（hax/F*） | 最高保証 |
| `ml-kem` | RustCrypto | はい | 定数時間、未監査 | エコシステム互換性 |
| `fips203` | integritychain | はい | 定数時間 | 純粋 Rust、no_std |

## まとめ

```text
┌─────────────────────────────────────────────────────────────────────┐
│  GROVEDB + ORCHARD 量子脅威サマリー                                  │
│                                                                     │
│  現在も将来も安全（ハッシュベース）：                                    │
│    ✓ Blake3 Merk ツリー、MMR、BulkAppendTree                        │
│    ✓ BLAKE2b KDF、PRF^expand                                       │
│    ✓ ChaCha20-Poly1305 対称暗号                                     │
│    ✓ すべての GroveDB 証明認証チェーン                                 │
│                                                                     │
│  データ保存前に修正（遡及的 HNDL）：                                    │
│    ✗ ノート暗号（ECDH 鍵合意）→ ハイブリッド KEM                       │
│    ✗ 値コミットメント（Pedersen）→ 金額露出                            │
│                                                                     │
│  量子コンピュータ到来前に修正（リアルタイムのみ）：                       │
│    ~ 支出認可 → ML-DSA / SLH-DSA                                    │
│    ~ ZK 証明 → STARKs / Plonky3                                    │
│    ~ Sinsemilla → ハッシュベースマークルツリー                         │
│                                                                     │
│  推奨タイムライン：                                                   │
│    2026-2028: アップグレード可能性の設計、保存形式のバージョン管理        │
│    2028-2030: ノート暗号に必須ハイブリッド KEM をデプロイ               │
│    2035+: 必要に応じて署名と証明システムを移行                          │
└─────────────────────────────────────────────────────────────────────┘
```

---
